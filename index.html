<!DOCTYPE html>
...
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ZATMENIE Club</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* --- –ù–ê–°–¢–†–û–ô–ö–ò –î–ò–ó–ê–ô–ù–ê (Royal Purple Luxury) --- */
        :root {
            --accent: #8B5CF6;
            --accent2: #EC4899;
            --gold: #F59E0B;
            --gold-grad: linear-gradient(90deg, #F59E0B, #FCD34D, #F59E0B);
            --blue-tick: #38BDF8;
            --bg-color: #070612;
            --surface: rgba(15, 16, 34, 0.7);
            --surface-hover: rgba(20, 22, 58, 0.85);
            --surface-glass: rgba(15, 16, 34, 0.95);
            --text-main: #F5F3FF;
            --text-hint: rgba(245, 243, 255, 0.60);
            --stroke: rgba(139, 92, 246, 0.18);
            --glow-color: rgba(139, 92, 246, 0.35);
            
            /* Status Colors */
            --status-free: #10b981;
            --status-busy: #ef4444;

            /* Sizes */
            --radius-card: 20px;
            --radius-btn: 14px;
            --btn-height: 50px;
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        body {
            background-color: var(--bg-color);
            background-image: 
                radial-gradient(circle at 50% 0%, rgba(139, 92, 246, 0.15) 0%, transparent 60%),
                linear-gradient(180deg, var(--bg-color) 0%, #05040a 100%);
            background-attachment: fixed;
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }

        /* --- –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø --- */
        .notification-toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: rgba(16, 185, 129, 0.9);
            backdrop-filter: blur(10px);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 13px;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            width: max-content;
            max-width: 90%;
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            will-change: transform, opacity;
        }
        .notification-toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* --- –õ–û–ì–û–¢–ò–ü --- */
        .brand-header {
            text-align: center;
            padding: 20px 0 10px 0;
            position: relative;
            z-index: 10;
        }

        .brand-name {
            font-size: 26px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 3px;
            background: linear-gradient(90deg, #fff, var(--accent), #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% auto;
            animation: shine 5s linear infinite;
            text-shadow: 0 0 30px rgba(139, 92, 246, 0.6);
        }

        @keyframes shine {
            to { background-position: 200% center; }
        }

        .brand-subtitle {
            font-size: 11px;
            color: var(--text-hint);
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-top: 4px;
        }

        /* --- TOGGLE SWITCH 18+ --- */
        .mode-switch-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            margin-bottom: 5px;
        }
        .mode-label {
            font-size: 12px;
            font-weight: 700;
            color: var(--text-hint);
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: color 0.3s;
        }
        .mode-label.active {
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }
        .mode-label.hot {
            color: #ef4444;
            text-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 46px;
            height: 24px;
        }
        .switch input { 
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--surface);
            border: 1px solid var(--stroke);
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 2px;
            bottom: 2px;
            background-color: #fff;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        /* --- –§–ò–õ–¨–¢–†–´ --- */
        .filters-wrapper {
            position: sticky;
            top: 0;
            z-index: 20;
            background: rgba(7, 6, 18, 0.8);
            backdrop-filter: blur(10px);
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            transform: translate3d(0,0,0);
        }

        .filters-container {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 0 16px;
            scrollbar-width: none;
        }
        .filters-container::-webkit-scrollbar { display: none; }

        .filter-chip {
            white-space: nowrap;
            padding: 8px 16px;
            border-radius: 20px;
            background: var(--surface);
            border: 1px solid var(--stroke);
            color: var(--text-hint);
            font-size: 13px;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .filter-chip.active {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.4);
        }

        /* --- –ö–ê–¢–ê–õ–û–ì --- */
        .screen { display: none; padding-bottom: calc(80px + var(--safe-bottom)); }
        .screen.active { display: block; animation: fadeIn 0.3s ease; }

        .container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            padding: 16px;
            transform: translate3d(0,0,0);
        }
        @media (min-width: 600px) { .container { grid-template-columns: repeat(2, 1fr); } }

        .card {
            background: var(--surface);
            backdrop-filter: blur(12px);
            border: 1px solid var(--stroke);
            border-radius: var(--radius-card);
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
            transform: translate3d(0,0,0);
            will-change: transform;
        }
        .card:active { transform: scale(0.98); transition: transform 0.1s; }

        .card-image-wrap {
            height: 440px;
            position: relative;
            border-bottom: 1px solid var(--stroke);
            overflow: hidden;
        }
        
        .card-image-wrap img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            transition: opacity 0.15s ease-out; 
            transform: translate3d(0,0,0);
            backface-visibility: hidden;
        }

        .card-badges {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            pointer-events: none; 
            z-index: 5;
        }
        .card-badges > * { pointer-events: auto; } 

        .status-badge {
            padding: 4px 10px;
            border-radius: 12px;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px);
            font-size: 11px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 5px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--status-free);
            box-shadow: 0 0 8px var(--status-free);
        }
        .status-dot.busy { background: var(--status-busy); box-shadow: 0 0 8px var(--status-busy); }

        .fav-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(4px);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: rgba(255,255,255,0.6);
            transition: transform 0.1s;
        }
        .fav-btn:active { transform: scale(0.9); }
        .fav-btn.active { color: #ec4899; background: rgba(236, 72, 153, 0.15); }

        .discount-badge {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: linear-gradient(135deg, #EF4444, #F59E0B);
            color: white;
            font-weight: 800;
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.5);
            animation: pulse 2s infinite;
            z-index: 5;
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* --- VIP –ö–ù–û–ü–ö–ê (–ü–õ–ê–í–ê–Æ–©–ê–Ø) --- */
        .vip-floating-btn {
            position: fixed;
            bottom: calc(20px + var(--safe-bottom));
            left: 50%;
            transform: translateX(-50%) translate3d(0,0,0);
            background: linear-gradient(90deg, #1e1e2f, #2d2d44);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 30px;
            padding: 12px 24px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 90;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5), 0 0 20px rgba(245, 158, 11, 0.2);
            cursor: pointer;
            width: 80%;
            justify-content: center;
            transition: transform 0.1s;
        }
        .vip-floating-btn:active { transform: translateX(-50%) scale(0.95); }
        .vip-text { font-weight: 800; color: #FFD700; text-transform: uppercase; letter-spacing: 1px; font-size: 14px; }
        .vip-icon { font-size: 18px; }

        /* --- VIP MODAL --- */
        .vip-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(10px);
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: flex-end;
        }
        .vip-overlay.active { opacity: 1; pointer-events: auto; }

        .vip-modal {
            width: 100%;
            background: linear-gradient(180deg, #1a1a2e 0%, #000 100%);
            border-top: 2px solid var(--gold);
            border-radius: 24px 24px 0 0;
            padding: 25px 20px calc(20px + var(--safe-bottom)) 20px;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            box-shadow: 0 -10px 40px rgba(245, 158, 11, 0.15);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .vip-overlay.active .vip-modal { transform: translateY(0); }

        .vip-header { text-align: center; margin-bottom: 10px; }
        .vip-title { 
            font-size: 24px; font-weight: 900; text-transform: uppercase; letter-spacing: 2px;
            background: var(--gold-grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin-bottom: 5px;
        }
        .vip-subtitle { color: var(--text-hint); font-size: 13px; text-transform: uppercase; letter-spacing: 1px; }

        .vip-list { display: flex; flex-direction: column; gap: 12px; }
        .vip-item { display: flex; align-items: flex-start; gap: 12px; background: rgba(255,255,255,0.05); padding: 12px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.05); }
        .vip-item-icon { font-size: 20px; min-width: 24px; }
        .vip-item-content { display: flex; flex-direction: column; }
        .vip-item-title { font-weight: 700; color: #fff; font-size: 14px; margin-bottom: 2px; }
        .vip-item-desc { font-size: 12px; color: var(--text-hint); line-height: 1.3; }

        .vip-buy-btn {
            background: var(--gold-grad);
            border: none; border-radius: 16px;
            height: 56px; width: 100%;
            font-weight: 800; font-size: 16px; color: #000;
            text-transform: uppercase; letter-spacing: 1px;
            margin-top: 10px;
            box-shadow: 0 5px 20px rgba(245, 158, 11, 0.3);
            cursor: pointer;
            position: relative; overflow: hidden;
        }
        .vip-buy-btn:active { transform: scale(0.98); }
        .vip-close { position: absolute; top: 15px; right: 15px; color: #fff; opacity: 0.5; font-size: 24px; cursor: pointer; }

        /* --- –°–¢–†–ï–õ–û–ß–ö–ò --- */
        .nav-arrow {
            position: absolute; top: 50%; transform: translateY(-50%); width: 36px; height: 36px; border-radius: 50%;
            background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(4px); border: 1px solid rgba(255, 255, 255, 0.2);
            color: white; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 10;
            font-size: 14px; user-select: none; touch-action: manipulation; 
        }
        .nav-arrow:active { background: rgba(139, 92, 246, 0.6); transform: translateY(-50%) scale(0.9); }
        .nav-arrow.left { left: 5px; }
        .nav-arrow.right { right: 5px; }

        /* --- –ö–ù–û–ü–ö–ê –ù–ê–ó–ê–î --- */
        .back-button {
            position: absolute; top: 15px; left: 15px; width: 40px; height: 40px; border-radius: 50%;
            background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex; align-items: center; justify-content: center; color: white; font-size: 18px; z-index: 50;
            cursor: pointer; transition: transform 0.1s;
        }
        .back-button:active { transform: scale(0.9); background: rgba(139, 92, 246, 0.6); }

        .card-content { padding: 14px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; }
        .name { font-size: 20px; font-weight: 700; color: var(--text-main); margin-bottom: 4px; }
        .price { color: var(--accent); font-weight: 600; font-size: 15px; margin-bottom: 12px; }

        .price-container { display: flex; justify-content: center; align-items: center; gap: 10px; margin-bottom: 20px; }
        .old-price { text-decoration: line-through; color: var(--text-hint); font-size: 16px; }
        .new-price { color: #EF4444; font-weight: 800; font-size: 22px; text-shadow: 0 0 15px rgba(239, 68, 68, 0.4); }

        /* --- –°–õ–ê–ô–î–ï–† --- */
        .detail-view { background: var(--bg-color); min-height: 100vh; padding-bottom: calc(160px + var(--safe-bottom)); }
        .slider-wrapper { position: relative; height: 400px; border-bottom: 1px solid var(--stroke); }
        .slider-container { display: flex; overflow-x: auto; scroll-snap-type: x mandatory; width: 100%; height: 100%; scrollbar-width: none; scroll-behavior: smooth; }
        .slider-container::-webkit-scrollbar { display: none; }
        
        .slider-slide { flex: 0 0 100%; width: 100%; height: 100%; scroll-snap-align: center; position: relative; }
        .slider-slide img { width: 100%; height: 100%; object-fit: cover; }

        .blurred-content { filter: blur(12px); transform: scale(1.1); }
        .lock-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(0,0,0,0.4); z-index: 2; text-align: center; }
        .lock-icon { font-size: 50px; margin-bottom: 10px; text-shadow: 0 0 20px rgba(0,0,0,0.8); }
        .lock-text { color: white; font-weight: 800; font-size: 18px; text-transform: uppercase; text-shadow: 0 0 10px black; }
        .lock-btn { margin-top: 15px; background: var(--gold); border: none; padding: 10px 20px; border-radius: 20px; font-weight: bold; cursor: pointer; animation: pulse 2s infinite; }

        .slider-dots { position: absolute; bottom: 20px; left: 0; width: 100%; display: flex; justify-content: center; gap: 8px; pointer-events: none; z-index: 6; }
        .dot { width: 8px; height: 8px; border-radius: 50%; background: rgba(255,255,255,0.3); transition: 0.3s; }
        .dot.active { background: #fff; transform: scale(1.2); }

        .detail-content { padding: 20px; }

        /* --- –í–ï–†–ò–§–ò–ö–ê–¶–ò–Ø --- */
        .verified-icon { color: var(--blue-tick); font-size: 18px; margin-left: 6px; cursor: pointer; vertical-align: middle; }
        
        .verification-block {
            background: rgba(56, 189, 248, 0.1);
            border: 1px solid var(--blue-tick);
            border-radius: 14px;
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .verification-block:active { transform: scale(0.98); }
        .ver-icon { font-size: 20px; }
        .ver-text { font-size: 12px; color: #fff; line-height: 1.4; }

        /* --- –ü–û–î–ê–†–ö–ò --- */
        .gifts-section { margin-top: 25px; padding: 15px; background: rgba(255,255,255,0.03); border-radius: 16px; border: 1px solid var(--stroke); }
        .gifts-title { font-size: 12px; font-weight: 700; color: var(--text-hint); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px; text-align: center; }
        .gifts-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .gift-card { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 10px 5px; text-align: center; border: 1px solid transparent; transition: 0.1s; cursor: pointer; }
        .gift-card:active { border-color: var(--accent); background: rgba(139, 92, 246, 0.1); transform: scale(0.95); }
        .gift-icon { font-size: 28px; margin-bottom: 5px; display: block; }
        .gift-name { font-size: 11px; color: #fff; display: block; margin-bottom: 2px; }
        .gift-price { font-size: 11px; font-weight: 700; color: var(--accent); }

        .priority-msg-btn { width: 100%; background: linear-gradient(90deg, #3b82f6, #2563eb); border: none; border-radius: 14px; height: 50px; display: flex; align-items: center; justify-content: center; gap: 10px; color: white; font-weight: 700; font-size: 14px; margin-top: 20px; margin-bottom: 10px; box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3); cursor: pointer; position: relative; }
        .priority-msg-btn:active { transform: scale(0.98); }
        
        .msg-badge {
            position: absolute; top: -5px; right: -5px;
            background: #ef4444; color: white;
            font-size: 11px; font-weight: 800;
            width: 20px; height: 20px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: 2px solid var(--bg-color);
            animation: pulse-red 2s infinite;
        }
        @keyframes pulse-red { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* --- –ö–ù–û–ü–ö–ê –ü–ï–†–ï–•–í–ê–¢–ê --- */
        .btn-intercept {
            width: 100%;
            min-height: var(--btn-height);
            border: none;
            border-radius: var(--radius-btn);
            font-weight: 700;
            font-size: 15px;
            text-transform: uppercase;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 16px;
            cursor: pointer;
            background: linear-gradient(90deg, #7c3aed, #db2777); /* –§–∏–æ–ª–µ—Ç–æ–≤–æ-—Ä–æ–∑–æ–≤—ã–π */
            box-shadow: 0 4px 15px rgba(219, 39, 119, 0.4);
            margin-top: 5px;
        }
        .btn-intercept:active { transform: scale(0.97); }

        /* --- –ß–ï–ö–ë–û–ö–° –ê–ù–û–ù–ò–ú–ù–û–°–¢–ò --- */
        .anon-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            cursor: pointer;
            justify-content: center;
        }
        .anon-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--accent);
        }
        .anon-text {
            font-size: 13px;
            color: var(--text-hint);
            font-weight: 600;
        }

        /* --- –û–¢–ó–´–í–´ --- */
        .reviews-section { margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--stroke); }
        .review-card { background: rgba(255,255,255,0.03); border-radius: 12px; padding: 12px; margin-bottom: 10px; font-size: 13px; animation: fadeIn 0.3s ease; }
        .review-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
        .review-author { color: var(--accent); font-weight: 700; }
        .review-date { font-size: 10px; color: var(--text-hint); opacity: 0.7; }
        .review-text { color: var(--text-hint); line-height: 1.4; font-style: italic; }

        .pagination-controls { display: flex; justify-content: center; align-items: center; gap: 20px; margin-top: 15px; padding-bottom: 10px; }
        .page-btn { width: 36px; height: 36px; border-radius: 50%; background: rgba(255, 255, 255, 0.05); border: 1px solid var(--stroke); color: #fff; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s; }
        .page-btn:active { background: var(--accent); border-color: var(--accent); }
        .page-info { font-size: 14px; color: var(--text-hint); font-weight: 600; }

        /* --- STICKY FOOTER --- */
        .detail-actions { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--surface-glass); backdrop-filter: blur(20px); padding: 16px 16px calc(16px + var(--safe-bottom)) 16px; border-top: 1px solid var(--stroke); display: flex; flex-direction: column; gap: 10px; z-index: 100; box-sizing: border-box; }
        
        .btn { width: 100%; min-height: var(--btn-height); border: none; border-radius: var(--radius-btn); font-weight: 700; font-size: 15px; text-transform: uppercase; color: #fff; display: flex; align-items: center; justify-content: center; padding: 0 16px; cursor: pointer; }
        .btn:active { transform: scale(0.97); }
        .btn-primary { background: linear-gradient(135deg, var(--accent), var(--accent2)); box-shadow: 0 4px 20px rgba(139, 92, 246, 0.4); }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); color: #fff; border: 1px solid rgba(255,255,255,0.2); min-height: 40px; font-size: 13px; margin-top: auto; }
        .btn-buy-pack { background: linear-gradient(90deg, #10b981, #059669); box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); position: relative; }
        .btn-buy-pack::after { content: 'üî•'; position: absolute; right: 20px; }
        .btn-buy-pack span { font-size: 13px; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="toast" class="notification-toast">
        <span>üí∞</span>
        <span id="toast-text">User123 –∫—É–ø–∏–ª VIP</span>
    </div>

    <div id="vip-window" class="vip-overlay" onclick="if(event.target === this) closeVip()">
        <div class="vip-modal">
            <div class="vip-close" onclick="closeVip()">‚úï</div>
            <div class="vip-header">
                <div class="vip-title">ZATMENIE VIP</div>
                <div class="vip-subtitle">–î–æ—Å—Ç—É–ø –Ω–∞ 1 –º–µ—Å—è—Ü</div>
            </div>
            
            <div class="vip-list">
                <div class="vip-item">
                    <div class="vip-item-icon">üîû</div>
                    <div class="vip-item-content">
                        <div class="vip-item-title">Uncensored</div>
                        <div class="vip-item-desc">–î–æ—Å—Ç—É–ø –∫ —Ñ–æ—Ç–æ –±–µ–∑ –±–ª—é—Ä–∞ –∏ —Ü–µ–Ω–∑—É—Ä—ã.</div>
                    </div>
                </div>
                <div class="vip-item">
                    <div class="vip-item-icon">üíÉ</div>
                    <div class="vip-item-content">
                        <div class="vip-item-title">Secret Models</div>
                        <div class="vip-item-desc">9 —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∫–ª–∞—Å—Å–∞ –ª—é–∫—Å.</div>
                    </div>
                </div>
                <div class="vip-item">
                    <div class="vip-item-icon">üè∑Ô∏è</div>
                    <div class="vip-item-content">
                        <div class="vip-item-title">–°–∫–∏–¥–∫–∏</div>
                        <div class="vip-item-desc">–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Å–∫–∏–¥–∫–∞ 10% –Ω–∞ –≤—Å–µ –ø–∞–∫–∏ –∏ –ø–æ–¥–∞—Ä–∫–∏.</div>
                    </div>
                </div>
                <div class="vip-item">
                    <div class="vip-item-icon">‚ö°</div>
                    <div class="vip-item-content">
                        <div class="vip-item-title">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</div>
                        <div class="vip-item-desc">–¢–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —á–∏—Ç–∞—é—Ç –ø–µ—Ä–≤—ã–º–∏.</div>
                    </div>
                </div>
            </div>

            <label class="anon-wrapper">
                <input type="checkbox" class="anon-checkbox" id="anon-check-vip">
                <span class="anon-text">üõ° –í–∫–ª—é—á–∏—Ç—å –ø–æ–ª–Ω—É—é –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å (+49‚ÇΩ)</span>
            </label>

            <button class="vip-buy-btn" onclick="processVipPayment()">
                –û—Ñ–æ—Ä–º–∏—Ç—å –¥–æ—Å—Ç—É–ø
            </button>
        </div>
    </div>

    <div class="brand-header">
        <div class="brand-name">üåë –ó–ê–¢–ú–ï–ù–ò–ï</div>
        <div class="brand-subtitle">Private Club</div>
        
        <div class="mode-switch-wrapper">
            <span class="mode-label active">üòá –°–∫—Ä–æ–º–Ω–æ</span>
            <label class="switch">
                <input type="checkbox" id="mode-checkbox" onclick="return trySwitchMode(event)">
                <span class="slider round"></span>
            </label>
            <span class="mode-label hot">üòà 18+</span>
        </div>
    </div>

    <div class="filters-wrapper" id="filters-wrapper">
        <div class="filters-container">
            <div class="filter-chip active" onclick="setFilter('all')">–í—Å–µ</div>
            <div class="filter-chip" onclick="setFilter('fav')">‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
        </div>
    </div>

    <div id="catalog-screen" class="screen active">
        <div class="container" id="cards-container"></div>
        <div class="vip-floating-btn" onclick="buyVip()">
            <div class="vip-icon">üíé</div>
            <div class="vip-text">VIP CLUB / 499‚ÇΩ</div>
        </div>
    </div>

    <div id="detail-screen" class="screen">
        <div class="detail-view">
            <div class="back-button" onclick="closeDetail()">‚ùÆ</div>
            <div class="slider-wrapper">
                <div class="nav-arrow left" onclick="scrollDetailSlider(-1)">‚ùÆ</div>
                <div class="nav-arrow right" onclick="scrollDetailSlider(1)">‚ùØ</div>
                <div class="slider-container" id="slider-container" onscroll="updateDots()"></div>
                <div class="slider-dots" id="slider-dots"></div>
            </div>

            <div class="detail-content">
                <div class="detail-title">
                    <span id="d-name">–ò–º—è</span>
                </div>

                <div style="display: flex; gap: 10px; margin-bottom: 15px; color: var(--text-hint); font-size: 14px;">
                    <span id="d-age">20 –ª–µ—Ç</span> ‚Ä¢ <span id="d-height">170 —Å–º</span>
                </div>
                <div class="price-container" id="d-price-container"></div>
                
                <div class="verification-block" onclick="showVerification()">
                    <div class="ver-icon">‚úÖ</div>
                    <div class="ver-text">–õ–∏—á–Ω–æ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–∞ 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏. –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–µ–π ZATMENIE Club.</div>
                </div>

                <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; line-height: 1.5; color: #ddd; font-size: 15px;" id="d-desc"></div>
                
                <div class="gifts-section">
                    <div class="gifts-title">–°–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç üéÅ</div>
                    <div class="gifts-grid">
                        <div class="gift-card" onclick="sendGift('champagne', 99)">
                            <span class="gift-icon">ü•Ç</span>
                            <span class="gift-name">–ò–≥—Ä–∏—Å—Ç–æ–µ</span>
                            <span class="gift-price">99‚ÇΩ</span>
                        </div>
                        <div class="gift-card" onclick="sendGift('rose', 299)">
                            <span class="gift-icon">üåπ</span>
                            <span class="gift-name">–ë—É–∫–µ—Ç</span>
                            <span class="gift-price">299‚ÇΩ</span>
                        </div>
                        <div class="gift-card" onclick="sendGift('diamond', 499)">
                            <span class="gift-icon">üíé</span>
                            <span class="gift-name">–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç</span>
                            <span class="gift-price">499‚ÇΩ</span>
                        </div>
                    </div>
                </div>

                <button class="priority-msg-btn" onclick="fakeMessageAlert()">
                    <span>üí¨</span> –ù–∞—á–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç (199‚ÇΩ)
                    <div class="msg-badge">1</div>
                </button>

                <div class="reviews-section">
                    <div style="font-weight: 700; margin-bottom: 15px; color: #fff;">‚≠ê –û—Ç–∑—ã–≤—ã –≥–æ—Å—Ç–µ–π</div>
                    <div id="d-reviews"></div>
                    <div class="pagination-controls" id="review-pagination">
                        <div class="page-btn" onclick="changeReviewPage(-1)">‚ùÆ</div>
                        <div class="page-info" id="page-num">1 / 1</div>
                        <div class="page-btn" onclick="changeReviewPage(1)">‚ùØ</div>
                    </div>
                </div>
            </div>

            <div class="detail-actions">
                <button id="btn-book" class="btn btn-primary" onclick="bookCurrentModel()">üìÖ –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</button>
                
                <div id="intercept-container" style="display:none; width:100%; margin-top:5px;">
                    <button class="btn btn-intercept" onclick="interceptBooking()">üöÄ –ü–µ—Ä–µ–∫—É–ø–∏—Ç—å –±—Ä–æ–Ω—å (+790‚ÇΩ)</button>
                    <div style="font-size:10px; color:#aaa; text-align:center; margin-top:5px;">–ì–∞—Ä–∞–Ω—Ç–∏—è –≤—Å—Ç—Ä–µ—á–∏. –í—ã –±—É–¥–µ—Ç–µ –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ.</div>
                </div>

                <label class="anon-wrapper" style="margin-top: 10px; justify-content: flex-start;">
                    <input type="checkbox" class="anon-checkbox" id="anon-check-pack">
                    <span class="anon-text">üõ° –í–∫–ª—é—á–∏—Ç—å –ø–æ–ª–Ω—É—é –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å (+49‚ÇΩ)</span>
                </label>

                <button class="btn btn-buy-pack" onclick="buyPhotoPack()">
                    <span style="font-size: 13px;">üì∏ –ö—É–ø–∏—Ç—å –ø–∞–∫ –æ—Ç–∫—Ä–æ–≤–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ (349‚ÇΩ)</span>
                </button>
            </div>
        </div>
    </div>

    <script>
    // --- 1. –õ–û–í–ï–¶ –û–®–ò–ë–û–ö (–ü–æ–∫–∞–∂–µ—Ç –ø—Ä–∏—á–∏–Ω—É, –µ—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –ø–∞–¥–∞–µ—Ç –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ) ---
    window.onerror = function(msg, url, line) {
        const errorBox = document.createElement('div');
        errorBox.style.cssText = 'position:fixed; top:0; left:0; width:100%; background:red; color:white; z-index:9999; padding:10px; font-size:12px; word-break:break-all; font-family:monospace;';
        errorBox.innerText = '‚ö†Ô∏è ERROR: ' + msg + '\nLine: ' + line;
        document.body.appendChild(errorBox);
        return false;
    };

    // --- 2. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø TELEGRAM ---
    let tg = window.Telegram.WebApp;
    try {
        tg.expand();
        tg.setHeaderColor('#070612');
        tg.setBackgroundColor('#070612');
    } catch (e) {
        console.error('TG init error:', e);
    }

    // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º (—á—Ç–æ–±—ã –Ω–µ –ø–∞–¥–∞–ª–æ –≤ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ)
    function safeStorageGet(key, defaultVal) {
        try {
            const val = localStorage.getItem(key);
            return val ? JSON.parse(val) : defaultVal;
        } catch (e) { return defaultVal; }
    }
    function safeStorageSet(key, val) {
        try { localStorage.setItem(key, JSON.stringify(val)); } catch (e) {}
    }

    // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–∏–±—Ä–∞—Ü–∏—è
    function haptic(type) {
        if (!tg.HapticFeedback) return;
        try {
            if (type === 'light') tg.HapticFeedback.impactOccurred('light');
            else if (type === 'medium') tg.HapticFeedback.impactOccurred('medium');
            else if (type === 'heavy') tg.HapticFeedback.impactOccurred('heavy');
            else if (type === 'success') tg.HapticFeedback.notificationOccurred('success');
            else if (type === 'error') tg.HapticFeedback.notificationOccurred('error');
            else if (type === 'warning') tg.HapticFeedback.notificationOccurred('warning');
        } catch(e) {}
    }

    // --- 3. –¢–í–û–ò –î–ê–ù–ù–´–ï –ò –õ–û–ì–ò–ö–ê ---

    function preloadImages() {
         Object.values(modelsData).forEach(model => {
            model.images.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        });
    }

    const userNames = ["Alex", "Dmitry", "Max", "Oleg", "Guest_77", "Mr_X", "Sergey", "Ivan", "Boss", "Anton", "Vlad", "Egor", "User3000", "VIP_King", "R.", "Stas"];
    const modelsGrammar = {
        'anna': { name: '–ê–Ω–Ω–∞', rod: '–ê–Ω–Ω—ã', dat: '–ê–Ω–Ω–µ', vin: '–ê–Ω–Ω—É', tvor: '–ê–Ω–Ω–æ–π' },
        'elena': { name: '–ï–ª–µ–Ω–∞', rod: '–ï–ª–µ–Ω—ã', dat: '–ï–ª–µ–Ω–µ', vin: '–ï–ª–µ–Ω—É', tvor: '–ï–ª–µ–Ω–æ–π' },
        'viki': { name: '–í–∏–∫–∏', rod: '–í–∏–∫–∏', dat: '–í–∏–∫–∏', vin: '–í–∏–∫–∏', tvor: '–í–∏–∫–∏' },
        'sofi': { name: '–°–æ—Ñ–∏', rod: '–°–æ—Ñ–∏', dat: '–°–æ—Ñ–∏', vin: '–°–æ—Ñ–∏', tvor: '–°–æ—Ñ–∏' },
        'maria': { name: '–ú–∞—Ä–∏—è', rod: '–ú–∞—Ä–∏–∏', dat: '–ú–∞—Ä–∏–∏', vin: '–ú–∞—Ä–∏—é', tvor: '–ú–∞—Ä–∏–µ–π' },
        'kate': { name: '–ö–µ–π—Ç', rod: '–ö–µ–π—Ç', dat: '–ö–µ–π—Ç', vin: '–ö–µ–π—Ç', tvor: '–ö–µ–π—Ç' },
        'eva': { name: '–ï–≤–∞', rod: '–ï–≤—ã', dat: '–ï–≤–µ', vin: '–ï–≤—É', tvor: '–ï–≤–æ–π' },
        'alice': { name: '–ê–ª–∏—Å–∞', rod: '–ê–ª–∏—Å—ã', dat: '–ê–ª–∏—Å–µ', vin: '–ê–ª–∏—Å—É', tvor: '–ê–ª–∏—Å–æ–π' },
        'diana': { name: '–î–∏–∞–Ω–∞', rod: '–î–∏–∞–Ω—ã', dat: '–î–∏–∞–Ω–µ', vin: '–î–∏–∞–Ω—É', tvor: '–î–∏–∞–Ω–æ–π' },
        'polina': { name: '–ü–æ–ª–∏–Ω–∞', rod: '–ü–æ–ª–∏–Ω—ã', dat: '–ü–æ–ª–∏–Ω–µ', vin: '–ü–æ–ª–∏–Ω—É', tvor: '–ü–æ–ª–∏–Ω–æ–π' },
        'nika': { name: '–ù–∏–∫–∞', rod: '–ù–∏–∫–∏', dat: '–ù–∏–∫–µ', vin: '–ù–∏–∫—É', tvor: '–ù–∏–∫–æ–π' }
    };
    const modelKeys = Object.keys(modelsGrammar);

    function showNotification() {
        const toast = document.getElementById('toast');
        const text = document.getElementById('toast-text');
        if (!toast || !text) return;

        const u = userNames[Math.floor(Math.random() * userNames.length)];
        const mKey = modelKeys[Math.floor(Math.random() * modelKeys.length)];
        const m = modelsGrammar[mKey];

        const scenarios = [
            `–∫—É–ø–∏–ª VIP –¥–æ—Å—Ç—É–ø`,
            `–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–ª ${m.vin}`,
            `–∫—É–ø–∏–ª –ø–∞–∫ —Ñ–æ—Ç–æ ${m.rod}`,
            `–Ω–∞—á–∞–ª –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç —Å ${m.tvor}`,
            `–æ—Ç–ø—Ä–∞–≤–∏–ª üíé ${m.dat}`,
            `–æ—Ç–ø—Ä–∞–≤–∏–ª üåπ ${m.dat}`,
            `–æ—Å—Ç–∞–≤–∏–ª –æ—Ç–∑—ã–≤ –¥–ª—è ${m.rod}`,
            `–ø—Ä–æ–¥–ª–∏–ª –ø–æ–¥–ø–∏—Å–∫—É`
        ];
        const msg = `${u} ${scenarios[Math.floor(Math.random() * scenarios.length)]}`;
        text.innerText = msg;
        toast.classList.add('show');
        setTimeout(() => { toast.classList.remove('show'); }, 4000);
        setTimeout(showNotification, Math.random() * 15000 + 8000);
    }
    setTimeout(showNotification, 5000);

    // --- –ì–ï–ù–ï–†–ê–¢–û–† –û–¢–ó–´–í–û–í (–¢–í–û–ô –ö–û–î) ---
    function getChaoticReviews(modelType) {
        const names = ["–ê–ª–µ–∫—Å–µ–π", "–î–º–∏—Ç—Ä–∏–π", "–ú–∞–∫—Å", "–°–µ—Ä–≥–µ–π", "–ò–≥–æ—Ä—å", "–í–æ–≤–∞", "–ê–Ω–¥—Ä–µ–π", "–û–ª–µ–≥", "Guest_77", "Mr.X", "–°—Ç–∞—Å", "–ê—Ä—Ç–µ–º", "Boss", "–ï–≤–≥–µ–Ω–∏–π", "Client", "Rustam", "Danil", "Viktor", "Anon", "Kirill", "Pavel", "Valery", "Roman", "Arthur", "Maxim", "Yury", "Ivan", "Den", "Misha", "Sasha", "Timur", "Vlad", "Anton", "Egor", "Nikita", "Vadim", "Gleb", "Mark", "Lev", "Konstantin"];
        const baseLibrary = {
            'intellectual': ["–ò–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –±–µ—Å–µ–¥–∞ –≤—ã—à–ª–∞", "–ù–∞—á–∏—Ç–∞–Ω–Ω–∞—è –¥–µ–≤—É—à–∫–∞", "–ü—Ä–∏—è—Ç–Ω—ã–π –≥–æ–ª–æ—Å", "–£–º–Ω–∞—è", "–°–∫—Ä–æ–º–Ω–∞—è", "–ù–µ –ø—É—Å—Ç—ã—à–∫–∞", "–í—Ä–µ–º—è –ø—Ä–æ–ª–µ—Ç–µ–ª–æ", "–•–æ—Ä–æ—à–µ–µ –≤–æ—Å–ø–∏—Ç–∞–Ω–∏–µ", "–°–ø–æ–∫–æ–π–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞", "–£—é—Ç–Ω–æ", "–ö–∞–∫ –ø—Å–∏—Ö–æ–ª–æ–≥", "–î—É—à–µ–≤–Ω–æ", "–ì–ª–∞–∑–∞ –¥–æ–±—Ä—ã–µ", "–£–º–µ–µ—Ç —Å–ª—É—à–∞—Ç—å", "–ù–µ –Ω–∞–≤—è–∑—á–∏–≤–∞—è", "–°–ø–∞—Å–∏–±–æ", "–†–µ–∫–æ–º–µ–Ω–¥—É—é", "–û—á–µ–Ω—å –º–∏–ª–∞—è", "–ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å", "–û—Å—Ç–∞–≤–∏–ª–∞ –ø—Ä–∏—è—Ç–Ω–æ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ", "–¢–æ–Ω–∫–∞—è –Ω–∞—Ç—É—Ä–∞", "–° –Ω–µ–π –ª–µ–≥–∫–æ", "–ù–∏–∫–∞–∫–æ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è", "–ò–Ω—Ç–µ–ª–ª–∏–≥–µ–Ω—Ç–Ω–∞—è", "–ü—Ä–∏—è—Ç–Ω–æ —É–¥–∏–≤–ª–µ–Ω", "–ù–µ –æ–∂–∏–¥–∞–ª", "–ö–ª–∞—Å—Å–Ω–∞—è", "–ü—Ä–æ—Å—Ç–∞—è", "–ë–µ–∑ –ø–∞—Ñ–æ—Å–∞", "–ò—Å–∫—Ä–µ–Ω–Ω—è—è", "–ù–∞—Å—Ç–æ—è—â–∞—è", "–ñ–∏–≤–∞—è", "–¢–µ–ø–ª–∞—è", "–ó–∞–±–æ—Ç–ª–∏–≤–∞—è", "–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–∞—è", "–ß—É—Ç–∫–∞—è", "–ì–ª—É–±–æ–∫–∞—è", "–ó–∞–≥–∞–¥–æ—á–Ω–∞—è", "–ñ–µ–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è", "–ú—è–≥–∫–∞—è"],
            'party': ["–û–≥–æ–Ω—å –±–∞–±–∞", "–í–µ—Å–µ–ª–æ", "–°–º–µ—è–ª–∏—Å—å", "–ó–∞–∂–∏–≥–∞–ª–∫–∞", "–¢–∞–Ω—Ü—É–µ—Ç –∫–ª–∞—Å—Å–Ω–æ", "–ö–∞—Ä–∞–æ–∫–µ —Å—É–ø–µ—Ä", "–≠–Ω–µ—Ä–≥–∏—è –ø—Ä–µ—Ç", "–ù–µ —Å–∫—É—á–Ω–æ", "–ü–æ–∑–∏—Ç–∏–≤", "–õ–µ–≥–∫–∞—è –Ω–∞ –ø–æ–¥—ä–µ–º", "–ü—Ä–æ—Å—Ç–∞—è", "–°–≤–æ–π —á–µ–ª–æ–≤–µ–∫", "–û—Ç–¥–æ—Ö–Ω—É–ª –¥—É—à–æ–π", "–ü—Ä–∞–∑–¥–Ω–∏–∫", "–î—Ä–∞–π–≤–æ–≤–∞—è", "–ë–∞—Ç–∞—Ä–µ–π–∫–∞", "–£—Å—Ç–∞–ª —Å–º–µ—è—Ç—å—Å—è", "–ö—Ä—É—Ç–æ –ø–æ—Ç—É—Å–∏–ª–∏", "–†–µ–∫–æ–º–µ–Ω–¥—É—é", "–ë–æ–º–±–∞", "–ü—É—à–∫–∞", "–†–∞–∫–µ—Ç–∞", "–ù–∞ —Å—Ç–∏–ª–µ", "–ß–µ—Ç–∫–∞—è", "–ë–µ–∑ –∫–æ–º–ø–ª–µ–∫—Å–æ–≤", "–†–∞—Å–∫—Ä–µ–ø–æ—â–µ–Ω–Ω–∞—è", "–í–µ—Å–µ–ª–∞—è", "–°–º–µ—à–Ω–∞—è", "–ü—Ä–∏–∫–æ–ª—å–Ω–∞—è", "–ö–∞–π—Ñ–æ–≤–∞—è", "–û—Ç—Ä—ã–≤ –±–∞—à–∫–∏", "–ù–µ–∑–∞–±—ã–≤–∞–µ–º–æ", "–Ø—Ä–∫–æ", "–®—É–º–Ω–æ", "–ê–∫—Ç–∏–≤–Ω–∞—è", "–ë–æ–¥—Ä–∞—è", "–ñ–∏–≤—á–∏–∫", "–¢–æ—Ä–ø–µ–¥–∞", "–£—Ä–∞–≥–∞–Ω", "–•–∞—Ä–∏–∑–º–∞"],
            'business': ["–®–∏–∫–∞—Ä–Ω–∞—è", "–°—Ç–∞—Ç—É—Å–Ω–∞—è", "–î–æ—Ä–æ–≥–æ –≤—ã–≥–ª—è–¥–∏—Ç", "–ù–∞—Å—Ç–æ—è—â–∞—è –ª–µ–¥–∏", "–°—Ç—Ä–æ–≥–∞—è –Ω–µ–º–Ω–æ–≥–æ", "–î–ª—è –¥–µ–ª–æ–≤–æ–≥–æ —É–∂–∏–Ω–∞", "–ü–∞—Ä—Ç–Ω–µ—Ä—ã –æ—Ü–µ–Ω–∏–ª–∏", "–ó–Ω–∞–µ—Ç —ç—Ç–∏–∫–µ—Ç", "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π –∑–Ω–∞–µ—Ç", "–û—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–∞—è", "–§–∏–≥—É—Ä–∞ —Ç–æ–ø", "–û–¥–µ—Ç–∞ —Å –∏–≥–æ–ª–æ—á–∫–∏", "–ü–∞—Ö–Ω–µ—Ç –¥–æ—Ä–æ–≥–æ", "–ö–æ—Ä–æ–ª–µ–≤–∞", "–í–∑–≥–ª—è–¥ —Ç–∞–∫–æ–π", "–•–∞—Ä–∏–∑–º–∞", "–ù–µ –¥–ª—è –≤—Å–µ—Ö", "–°—Ç–æ–∏—Ç —Å–≤–æ–∏—Ö –¥–µ–Ω–µ–≥", "–ü—É–Ω–∫—Ç—É–∞–ª—å–Ω–∞—è", "–°–µ—Ä–≤–∏—Å –Ω–∞ —É—Ä–æ–≤–Ω–µ", "–í—ã—Å—à–∏–π –∫–ª–∞—Å—Å", "–ü—Ä–µ–º–∏—É–º", "–õ–∞–∫—à–µ—Ä–∏", "–≠–ª–∏—Ç–Ω–∞—è", "–†–æ—Å–∫–æ—à–Ω–∞—è", "–ë—Ä–∏–ª–ª–∏–∞–Ω—Ç", "–£–∫—Ä–∞—à–µ–Ω–∏–µ –≤–µ—á–µ—Ä–∞", "–î–æ—Å—Ç–æ–π–Ω–∞—è", "–£—Ä–æ–≤–µ–Ω—å", "–ö–∞—á–µ—Å—Ç–≤–æ", "–†–µ—Å–ø–µ–∫—Ç", "–£–≤–∞–∂–µ–Ω–∏–µ", "–í–ø–µ—á–∞—Ç–ª—è–µ—Ç", "–≠—Ñ—Ñ–µ–∫—Ç–Ω–∞—è", "–°–Ω–æ–≥—Å—à–∏–±–∞—Ç–µ–ª—å–Ω–∞—è", "–ò–¥–µ–∞–ª—å–Ω–∞—è", "–ë–µ–∑—É–ø—Ä–µ—á–Ω–∞—è", "–ì—Ä–∞—Ü–∏–æ–∑–Ω–∞—è", "–°—Ç–∞—Ç–Ω–∞—è", "–ü–æ—Ä–æ–¥–∞"],
            'romantic': ["–°–∞–º–∞—è –Ω–µ–∂–Ω–∞—è", "–ñ–µ–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è", "–•—Ä—É–ø–∫–∞—è", "–•–æ—á–µ—Ç—Å—è –∑–∞—â–∏—â–∞—Ç—å", "–†–æ–º–∞–Ω—Ç–∏–∫–∞", "–ì—É–ª—è–ª–∏ –¥–æ–ª–≥–æ", "–†—É—á–∫–∏ —Ç–µ–ø–ª—ã–µ", "–£–ª—ã–±–∫–∞ –∫—Ä–∞—Å–∏–≤–∞—è", "–î–æ–±—Ä–∞—è", "–ö–∞–∫ –∞–Ω–≥–µ–ª", "–°–ø–æ–∫–æ–π–Ω–∞—è", "–£—é—Ç–Ω–∞—è", "–î–æ–º–∞—à–Ω—è—è", "–ù–µ—Ç –ø–æ–Ω—Ç–æ–≤", "–°—Ç–µ—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è", "–¢—Ä–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è", "–î—É—à–µ–≤–Ω–æ", "–¢–µ–ø–ª–æ", "–ü—Ä–∏—è—Ç–Ω–∞—è", "–õ–∞—Å–∫–æ–≤–∞—è", "–ú–∏–ª–∞—à–∫–∞", "–ó–∞–π–∫–∞", "–°–æ–ª–Ω—ã—à–∫–æ", "–¶–≤–µ—Ç–æ—á–µ–∫", "–ö—É–∫–æ–ª–∫–∞", "–ü—Ä–∏–Ω—Ü–µ—Å—Å–∞", "–§–µ—è", "–í–æ–ª—à–µ–±–Ω–∞—è", "–ß—É–¥–µ—Å–Ω–∞—è", "–ü—Ä–µ–∫—Ä–∞—Å–Ω–∞—è", "–û—á–∞—Ä–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è", "–í–æ—Å—Ö–∏—Ç–∏—Ç–µ–ª—å–Ω–∞—è", "–ù–µ–æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω–∞—è", "–°–≤–µ—Ç–ª–∞—è", "–ß–∏—Å—Ç–∞—è", "–ù–∞–∏–≤–Ω–∞—è", "–ò—Å–∫—Ä–µ–Ω–Ω—è—è", "–õ—é–±–∏–º–∞—è", "–†–æ–¥–Ω–∞—è", "–ë–ª–∏–∑–∫–∞—è"]
        };
        const longReviewsLibrary = {
            'intellectual': ["–ß–µ—Å—Ç–Ω–æ –≥–æ–≤–æ—Ä—è, —à–µ–ª –ø—Ä–æ—Å—Ç–æ –Ω–∞ –∫—Ä–∞—Å–∏–≤—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É, –∞ –≤—Å—Ç—Ä–µ—Ç–∏–ª —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—É—é –¥—É—à—É. –û–±—Å—É–∂–¥–∞–ª–∏ –≤—Å—ë: –æ—Ç –Ω–æ–≤–∏–Ω–æ–∫ –∫–∏–Ω–æ –¥–æ —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏.", "–ê–Ω–Ω–∞ ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –≤–Ω–µ—à–Ω–æ—Å—Ç—å, —ç—Ç–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç. –ü—Ä–∏—è—Ç–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤—Ä–µ–º—è —Å —á–µ–ª–æ–≤–µ–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–Ω–∏–º–∞–µ—Ç —Ç–æ–Ω–∫–∏–π —é–º–æ—Ä.", "–ú—ã –ø—Ä–æ—Å–∏–¥–µ–ª–∏ –≤ –∫–∞—Ñ–µ —Ç—Ä–∏ —á–∞—Å–∞, –∏ —è –¥–∞–∂–µ –≤ —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–µ –∑–∞–≥–ª—è–Ω—É–ª. –û—á–µ–Ω—å –≥–ª—É–±–æ–∫–∏–π —á–µ–ª–æ–≤–µ–∫.", "–ï—Å–ª–∏ –≤—ã –∏—â–µ—Ç–µ –ø—É—Å—Ç—ã—à–∫—É, —Ç–æ –≤–∞–º –º–∏–º–æ. –ó–¥–µ—Å—å –µ—Å—Ç—å –æ —á–µ–º –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å, –µ—Å—Ç—å —á—Ç–æ –æ–±—Å—É–¥–∏—Ç—å.", "–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –Ω–æ –æ–Ω–∞ –∑–Ω–∞–µ—Ç —Ç–æ–ª–∫ –≤ —Ö–æ—Ä–æ—à–µ–º –≤–∏–Ω–µ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ. –°—Ö–æ–¥–∏–ª–∏ –Ω–∞ –≤—ã—Å—Ç–∞–≤–∫—É, –ø–æ—Ç–æ–º –ø–æ—É–∂–∏–Ω–∞–ª–∏."],
            'party': ["–ú—ã —Å –ø–∞—Ä–Ω—è–º–∏ –¥—É–º–∞–ª–∏, —á—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø–æ—Å–∏–¥–∏–º –≤ –∫–∞—Ä–∞–æ–∫–µ, –∞ –æ–Ω–∞ —É—Å—Ç—Ä–æ–∏–ª–∞ –Ω–∞–º –Ω–∞—Å—Ç–æ—è—â–∏–π –∫–æ–Ω—Ü–µ—Ä—Ç! –í–µ—Å—å –∫–ª—É–± –Ω–∞ –Ω–∞—Å —Å–º–æ—Ç—Ä–µ–ª.", "–ï—Å–ª–∏ –≤–∞–º —Å–∫—É—á–Ω–æ –∏ —Ö–æ—á–µ—Ç—Å—è –ø—Ä–∞–∑–¥–Ω–∏–∫–∞ ‚Äî –±–µ—Ä–∏—Ç–µ –µ—ë. –Ø —Ç–∞–∫ –Ω–µ —Å–º–µ—è–ª—Å—è —Å–æ —à–∫–æ–ª—ã. –û—á–µ–Ω—å –ª–µ–≥–∫–∞—è, –≤–µ—Å–µ–ª–∞—è.", "–¢–∞–Ω—Ü—É–µ—Ç –∫–∞–∫ –±–æ–≥–∏–Ω—è. –ú—ã –∑–∞–∫—Ä—ã–ª–∏ –∫–ª—É–±, –ø–æ—Ç–æ–º –ø–æ–µ—Ö–∞–ª–∏ –≤—Å—Ç—Ä–µ—á–∞—Ç—å —Ä–∞—Å—Å–≤–µ—Ç.", "–ù–∞—Å—Ç–æ—è—â–∏–π —É—Ä–∞–≥–∞–Ω! –í—Ç—è–Ω—É–ª–∞ –º–µ–Ω—è –≤ —Ç–∞–∫–∏–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è, –æ –∫–æ—Ç–æ—Ä—ã—Ö –≤–Ω—É–∫–∞–º –Ω–µ —Ä–∞—Å—Å–∫–∞–∂–µ—à—å.", "–° –Ω–µ–π —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è –∂–∏–≤—ã–º. –ù–∏–∫–∞–∫–æ–π —Å–∫—É–∫–∏, –Ω–∏–∫–∞–∫–æ–≥–æ –ø–∞—Ñ–æ—Å–∞. –ü—Ä–æ—Å—Ç–æ —á–∏—Å—Ç—ã–π –¥—Ä–∞–π–≤ –∏ –ø–æ–∑–∏—Ç–∏–≤."],
            'business': ["–ù—É–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –Ω–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –∏–∑ –ö–∏—Ç–∞—è. –û–Ω–∞ —Å–ø—Ä–∞–≤–∏–ª–∞—Å—å –Ω–∞ 200%. –ò–¥–µ–∞–ª—å–Ω—ã–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π, —Å–¥–µ—Ä–∂–∞–Ω–Ω–æ—Å—Ç—å.", "–ò—Å–∫–∞–ª —Å–ø—É—Ç–Ω–∏—Ü—É –¥–ª—è –ø–æ—Ö–æ–¥–∞ –≤ –æ–ø–µ—Ä—É. –ù—É–∂–µ–Ω –±—ã–ª —É—Ä–æ–≤–µ–Ω—å, —á—Ç–æ–±—ã –Ω–µ —Å—Ç—ã–¥–Ω–æ –±—ã–ª–æ. –û–Ω–∞ –ø—Ä–µ–≤–∑–æ—à–ª–∞ –æ–∂–∏–¥–∞–Ω–∏—è.", "–≠—Ç–æ –≤—ã—Å—à–∏–π –ø–∏–ª–æ—Ç–∞–∂. –ù–∏–∫–∞–∫–∏—Ö –ª–∏—à–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤, –Ω–∏–∫–∞–∫–∏—Ö –∫–∞–ø—Ä–∏–∑–æ–≤. –ü—Ä–∏—à–ª–∞ –≤–æ–≤—Ä–µ–º—è, –≤—ã–≥–ª—è–¥–µ–ª–∞ –Ω–∞ –º–∏–ª–ª–∏–æ–Ω.", "–î–ª—è —Å—Ç–∞—Ç—É—Å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ª—É—á—à–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –Ω–µ—Ç. –û–Ω–∞ —É–º–µ–µ—Ç –¥–µ—Ä–∂–∞—Ç—å –ª–∏—Ü–æ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –±–µ—Å–µ–¥—É.", "–í –∂–∏–∑–Ω–∏ –¥–∞–∂–µ –ª—É—á—à–µ, —á–µ–º –Ω–∞ —Ñ–æ—Ç–æ. –î–æ—Ä–æ–≥–∞—è –∂–µ–Ω—â–∏–Ω–∞ –¥–ª—è –¥–æ—Ä–æ–≥–∏—Ö –º—É–∂—á–∏–Ω."],
            'romantic': ["–ò—Å–∫–∞–ª —Ç–µ–ø–ª–∞ –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ —Ç—è–∂–µ–ª–æ–π –Ω–µ–¥–µ–ª–∏. –û–Ω–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —É—é—Ç –≤ —á–∏—Å—Ç–æ–º –≤–∏–¥–µ. –°–∏–¥–µ–ª–∏, –ø–∏–ª–∏ —á–∞–π, –≥–æ–≤–æ—Ä–∏–ª–∏ –Ω–∏ –æ —á–µ–º.", "–Ø –¥—É–º–∞–ª, —Ç–∞–∫–∏—Ö –Ω–µ–∂–Ω—ã—Ö —É–∂–µ –Ω–µ –±—ã–≤–∞–µ—Ç. –°–º–æ—Ç—Ä–∏—Ç –Ω–∞ —Ç–µ–±—è —Ç–∞–∫–∏–º–∏ –≥–ª–∞–∑–∞–º–∏, —á—Ç–æ –∑–∞–±—ã–≤–∞–µ—à—å –æ–±–æ –≤—Å–µ–º.", "–ú—ã –ø—Ä–æ—Å—Ç–æ –≥—É–ª—è–ª–∏ –ø–æ –ø–∞—Ä–∫—É, –∫–æ—Ä–º–∏–ª–∏ —É—Ç–æ–∫, –µ–ª–∏ –º–æ—Ä–æ–∂–µ–Ω–æ–µ. –Ø –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞–ª —Å–µ–±—è —Å–Ω–æ–≤–∞ 18-–ª–µ—Ç–Ω–∏–º.", "–ù–∏–∫–∞–∫–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è, –Ω–∏–∫–∞–∫–æ–π —Ñ–∞–ª—å—à–∏. –û–Ω–∞ –Ω–∞—Å—Ç–æ—è—â–∞—è. –û—á–µ–Ω—å –º—è–≥–∫–∞—è, —Ç–µ–ø–ª–∞—è, –∂–µ–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è.", "–ü—Ä–æ–≤–µ–ª–∏ –≤–µ—á–µ—Ä –ø—Ä–∏ —Å–≤–µ—á–∞—Ö. –û–Ω–∞ —Å–æ–∑–¥–∞–ª–∞ —Ç–∞–∫—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É, —á—Ç–æ —è –Ω–µ —Ö–æ—Ç–µ–ª —É—Ö–æ–¥–∏—Ç—å."]
        };

        const phrases = baseLibrary[modelType];
        const longPhrases = longReviewsLibrary[modelType];
        const shuffledPhrases = phrases.sort(() => 0.5 - Math.random());
        const shuffledLongPhrases = longPhrases.sort(() => 0.5 - Math.random());
        const selectedPhrases = shuffledPhrases.slice(0, 40); 
        const reviews = [];

        function chaoticFormat(text) {
            const r = Math.random();
            if (r < 0.3) text = text.charAt(0).toLowerCase() + text.slice(1);
            const endR = Math.random();
            const isLong = text.length > 50;
            if (!isLong) {
                if (endR < 0.2) text += "."; else if (endR < 0.4) text += ")"; else if (endR < 0.5) text += "))"; else if (endR < 0.6) text += "!";
            }
            if (Math.random() < 0.1) text = text.replace("–û—á–µ–Ω—å", "–û—á");
            if (Math.random() < 0.1) text = text.replace("–°–ø–∞—Å–∏–±–æ", "–°–ø—Å");
            return text;
        }

        for (let i = 0; i < 40; i++) {
            const name = names[Math.floor(Math.random() * names.length)];
            let text = "";
            if (Math.random() < 0.25 && shuffledLongPhrases.length > 0) {
                text = shuffledLongPhrases[i % shuffledLongPhrases.length];
            } else {
                let baseText = selectedPhrases[i]; 
                if (Math.random() > 0.6) {
                     let secondText = selectedPhrases[(i + 5) % selectedPhrases.length]; 
                     if (secondText !== baseText) baseText += ". " + secondText;
                }
                text = chaoticFormat(baseText);
            }
            const date = new Date(2026, 0, 27); 
            date.setDate(date.getDate() - Math.floor(Math.random() * 60)); 
            const dateStr = date.toLocaleDateString('ru-RU', {day: 'numeric', month: 'long', year: 'numeric'});
            reviews.push({ user: name, text: text, date: dateStr, rawDate: date });
        }
        reviews.sort((a, b) => b.rawDate - a.rawDate);
        return reviews;
    }

    // --- –ú–û–î–ï–õ–ò (–í–°–ï 10 –®–¢–£–ö) ---
    const modelsData = {
        'anna': { name: "–ê–Ω–Ω–∞", age: 23, height: 170, price: "5000‚ÇΩ / —á–∞—Å", discountPrice: "4000‚ÇΩ / —á–∞—Å", category: "blonde", status: "free", isTop: true, images: ["https://i.postimg.cc/Jnsw19KB/Photo-(87).jpg", "https://i.postimg.cc/Qxkzr8hh/Photo-(86).jpg", "https://i.postimg.cc/2SS0Rn0s/Photo-(63).jpg"], desc: "–£—Ç–æ–Ω—á–µ–Ω–Ω–∞—è –±—Ä—é–Ω–µ—Ç–∫–∞ —Å –æ—Ç–ª–∏—á–Ω—ã–º —á—É–≤—Å—Ç–≤–æ–º —é–º–æ—Ä–∞.", reviews: getChaoticReviews('intellectual') },
        'viki': { name: "–í–∏–∫–∏", age: 20, height: 165, price: "7000‚ÇΩ / —á–∞—Å", category: "blonde", status: "free", isTop: false, images: ["https://i.postimg.cc/BQ6FJNGf/Photo-(118).jpg", "https://i.postimg.cc/3JcvNpKz/Photo-(64).jpg", "https://i.postimg.cc/VNy0B80j/Photo-(12).jpg"], desc: "–í–µ—Å–µ–ª–∞—è, –∞–∫—Ç–∏–≤–Ω–∞—è, –ª—é–±–ª—é —Ç–∞–Ω—Ü—ã!", reviews: getChaoticReviews('party') },
        'sofi': { name: "–°–æ—Ñ–∏", age: 21, height: 172, price: "5500‚ÇΩ / —á–∞—Å", category: "blonde", status: "free", isTop: true, images: ["https://i.postimg.cc/wvqv0TqM/Photo-(40).jpg", "https://i.postimg.cc/g0Ndcyph/Photo-(214).jpg", "https://i.postimg.cc/sXLr7V1H/Photo-(220).jpg"], desc: "–ù–µ–∂–Ω–∞—è –∏ —Ä–æ–º–∞–Ω—Ç–∏—á–Ω–∞—è –Ω–∞—Ç—É—Ä–∞.", reviews: getChaoticReviews('romantic') },
        'maria': { name: "–ú–∞—Ä–∏—è", age: 24, height: 168, price: "4500‚ÇΩ / —á–∞—Å", discountPrice: "3600‚ÇΩ / —á–∞—Å", category: "brunette", status: "free", isTop: false, images: ["https://i.postimg.cc/CMf17tYd/Photo-(248).jpg", "https://i.postimg.cc/pXfdbFmb/Photo-(247).jpg", "https://i.postimg.cc/4N63k9YH/Photo-(284).jpg"], desc: "–°—Ç—Ä–∞—Å—Ç–Ω–∞—è –∏ –Ω–µ–∂–Ω–∞—è —Å—É—á–∫–∞.", reviews: getChaoticReviews('party') },
        'kate': { name: "–ö–µ–π—Ç", age: 22, height: 176, price: "8000‚ÇΩ / —á–∞—Å", category: "blonde", status: "busy", isTop: true, images: ["https://i.postimg.cc/QMwDW8BG/1-457261996.jpg", "https://i.postimg.cc/yd8RWTSt/1-457262659.jpg", "https://i.postimg.cc/63bvZGr3/1-457262949.jpg"], desc: "–ú–æ–¥–µ–ª—å —Ç–æ–ø-—É—Ä–æ–≤–Ω—è.", reviews: getChaoticReviews('business') },
        'eva': { name: "–ï–≤–∞", age: 19, height: 164, price: "6000‚ÇΩ / —á–∞—Å", category: "brunette", status: "free", isTop: true, images: ["https://i.postimg.cc/QM4QQPDP/Photo-(23).jpg", "https://i.postimg.cc/KzCtVM1y/Photo-(29).jpg", "https://i.postimg.cc/SQz69DPy/Photo-(5).jpg"], desc: "–°–æ—á–Ω–∞—è –ª–µ–¥–∏ —Å –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–º–∏ –∏–∑–≥–∏–±–∞–º–∏.", reviews: getChaoticReviews('romantic') },
        'alice': { name: "–ê–ª–∏—Å–∞", age: 23, height: 170, price: "7000‚ÇΩ / —á–∞—Å", category: "blonde", status: "free", isTop: false, images: ["https://i.postimg.cc/0NbMsNgG/Photo-(161).jpg", "https://i.postimg.cc/85v77nz6/Photo-(198).jpg", "https://i.postimg.cc/ZKbqmqpP/Photo-(343).jpg"], desc: "–°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –∏ –∞–∫—Ç–∏–≤–Ω–∞—è.", reviews: getChaoticReviews('party') },
        'diana': { name: "–î–∏–∞–Ω–∞", age: 26, height: 178, price: "7500‚ÇΩ / —á–∞—Å", category: "brunette", status: "free", isTop: false, images: ["https://i.postimg.cc/zBNrkdkn/Photo-(47).jpg", "https://i.postimg.cc/QCnwvSpr/Photo-(294).jpg", "https://i.postimg.cc/L6wGTC9t/Photo-(37).jpg"], desc: "–í—ã—Å–æ–∫–∞—è, —Å—Ç–∞—Ç–Ω–∞—è –±—Ä—é–Ω–µ—Ç–∫–∞.", reviews: getChaoticReviews('business') },
        'polina': { name: "–ü–æ–ª–∏–Ω–∞", age: 20, height: 169, price: "9000‚ÇΩ / —á–∞—Å", category: "blonde", status: "busy", isTop: true, images: ["https://i.postimg.cc/SKqTTHwk/261888104-457293776.jpg", "https://i.postimg.cc/rw2QsvF2/261888104-457293774.jpg", "https://i.postimg.cc/8C2hXvFv/261888104-457291634.jpg"], desc: "–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è –≤–Ω–µ—à–Ω–æ—Å—Ç—å –∏ –º–∞–Ω–µ—Ä—ã.", reviews: getChaoticReviews('business') },
        'nika': { name: "–ù–∏–∫–∞", age: 22, height: 166, price: "5000‚ÇΩ / —á–∞—Å", discountPrice: "4000‚ÇΩ / —á–∞—Å", category: "brunette", status: "free", isTop: false, images: ["https://i.postimg.cc/3RjDLc5z/263490721-457263040.jpg", "https://i.postimg.cc/J0PH8Hnm/263490721-457262855.jpg", "https://i.postimg.cc/Kvp3sTwz/263490721-457262767.jpg"], desc: "–¢–≤–æ—Ä—á–µ—Å–∫–∞—è –ª–∏—á–Ω–æ—Å—Ç—å.", reviews: getChaoticReviews('romantic') }
    };

    // --- –§–£–ù–ö–¶–ò–û–ù–ê–õ ---

    let currentFilter = 'all';
    let favorites = safeStorageGet('zatmenie_favs', []);
    let currentModelId = null;
    let catalogImageIndexes = {}; 
    let currentReviewPage = 1;
    const reviewsPerPage = 10;

    function toggleFav(e, id) {
        e.stopPropagation(); 
        if (favorites.includes(id)) {
            favorites = favorites.filter(fav => fav !== id);
            haptic('light');
        } else {
            favorites.push(id);
            haptic('success');
        }
        safeStorageSet('zatmenie_favs', favorites);
        renderCatalog(); 
    }

    function setFilter(filter) {
        currentFilter = filter;
        document.querySelectorAll('.filter-chip').forEach(chip => {
            chip.classList.remove('active');
            if (chip.innerText.toLowerCase().includes(filter === 'fav' ? '–∏–∑–±—Ä–∞–Ω–Ω–æ–µ' : '–≤—Å–µ')) {
                chip.classList.add('active');
            }
        });
        haptic('light');
        renderCatalog();
    }

    function switchCardImage(e, id, direction) {
        e.stopPropagation();
        haptic('light');
        const data = modelsData[id];
        if (!catalogImageIndexes[id]) catalogImageIndexes[id] = 0;
        let newIndex = catalogImageIndexes[id] + direction;
        if (newIndex < 0) newIndex = data.images.length - 1;
        if (newIndex >= data.images.length) newIndex = 0;
        catalogImageIndexes[id] = newIndex;
        
        const imgElement = document.getElementById(`card-img-${id}`);
        const lockElement = document.getElementById(`card-lock-${id}`);
        
        if (imgElement) {
            imgElement.style.opacity = '0';
            setTimeout(() => {
                imgElement.src = data.images[newIndex];
                if (newIndex === 2) {
                    imgElement.classList.add('blurred-content');
                    if(lockElement) lockElement.style.display = 'flex';
                } else {
                    imgElement.classList.remove('blurred-content');
                    if(lockElement) lockElement.style.display = 'none';
                }
                imgElement.style.opacity = '1';
            }, 200);
        }
    }

    function renderCatalog() {
        const container = document.getElementById('cards-container');
        let html = '';
        let index = 0;
        
        Object.keys(modelsData).forEach(id => {
            const data = modelsData[id];
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
            if (data.status === 'hidden') return;
            let show = false;
            if (currentFilter === 'all') show = true;
            else if (currentFilter === 'fav') show = favorites.includes(id);
            if (!show) return;

            const isFav = favorites.includes(id);
            const statusText = data.status === 'free' ? '–°–≤–æ–±–æ–¥–Ω–∞' : '–ó–∞–Ω—è—Ç–∞';
            const dotClass = data.status === 'free' ? '' : 'busy';
            const delay = index * 0.05;

            // –¢–µ–∫—É—â–µ–µ —Ñ–æ—Ç–æ
            if (catalogImageIndexes[id] === undefined) catalogImageIndexes[id] = 0;
            const currentImg = data.images[catalogImageIndexes[id]];
            const isSecret = catalogImageIndexes[id] === 2;
            const blurClass = isSecret ? 'blurred-content' : '';
            const lockDisplay = isSecret ? 'flex' : 'none';

            let discountHtml = '';
            if (data.discountPrice) {
                discountHtml = `<div class="discount-badge">üî• -20%</div>`;
            }

            html += `
            <div class="card" onclick="openDetail('${id}')" style="animation: fadeIn 0.5s ease ${delay}s backwards">
                <div class="card-image-wrap">
                    <div class="nav-arrow left" onclick="switchCardImage(event, '${id}', -1)">‚ùÆ</div>
                    <div class="nav-arrow right" onclick="switchCardImage(event, '${id}', 1)">‚ùØ</div>
                    <img id="card-img-${id}" src="${currentImg}" class="${blurClass}" alt="${data.name}">
                    
                    <div id="card-lock-${id}" class="lock-overlay" style="display: ${lockDisplay};" onclick="buyVip(); event.stopPropagation();">
                        <div class="lock-icon">üîí</div>
                        <div class="lock-text">–°–∫—Ä—ã—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç</div>
                        <button class="lock-btn">–û—Ç–∫—Ä—ã—Ç—å –≤ VIP</button>
                    </div>

                    <div class="card-badges">
                        <div class="status-badge">
                            <div class="status-dot ${dotClass}"></div>
                            ${statusText}
                        </div>
                        <button class="fav-btn ${isFav ? 'active' : ''}" onclick="toggleFav(event, '${id}')">
                            ${isFav ? '‚ù§Ô∏è' : 'ü§ç'}
                        </button>
                    </div>
                    ${discountHtml}
                </div>
                <div class="card-content">
                    <div class="name">${data.name}, ${getAgeString(data.age)}</div>
                    <div class="price" style="${data.discountPrice ? 'color:#EF4444' : ''}">
                        ${data.discountPrice ? data.discountPrice : data.price}
                    </div>
                    <button class="btn btn-secondary">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                </div>
            </div>`;
            index++;
        });
        
        if (html === '') {
            container.innerHTML = '<div style="text-align:center; padding: 40px; color:#666;">–ù–∏–∫–æ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üòî</div>';
        } else {
            container.innerHTML = html;
        }
    }

    function renderReviews() {
        if (!currentModelId) return;
        const data = modelsData[currentModelId];
        if (!data || !data.reviews) return;
        const reviewsCont = document.getElementById('d-reviews');
        const totalPages = Math.ceil(data.reviews.length / reviewsPerPage);
        if (currentReviewPage < 1) currentReviewPage = 1;
        if (currentReviewPage > totalPages) currentReviewPage = totalPages;
        const start = (currentReviewPage - 1) * reviewsPerPage;
        const end = start + reviewsPerPage;
        const pageReviews = data.reviews.slice(start, end);
        let html = '';
        pageReviews.forEach(r => {
            html += `
                <div class="review-card">
                    <div class="review-header">
                        <div class="review-author">${r.user}</div>
                        <div class="review-date">${r.date}</div>
                    </div>
                    <div class="review-text">"${r.text}"</div>
                </div>
            `;
        });
        reviewsCont.innerHTML = html;
        document.getElementById('page-num').innerText = `${currentReviewPage} / ${totalPages}`;
    }

    function changeReviewPage(direction) {
        haptic('light');
        currentReviewPage += direction;
        renderReviews();
    }

    function scrollDetailSlider(direction) {
        const container = document.getElementById('slider-container');
        const width = container.clientWidth;
        haptic('light');
        container.scrollBy({ left: direction * width, behavior: 'smooth' });
    }

    function openDetail(id) {
        haptic('light');
        currentModelId = id;
        currentReviewPage = 1;
        const data = modelsData[id];
        const sliderCont = document.getElementById('slider-container');
        const sliderDots = document.getElementById('slider-dots');
        let slidesHtml = '';
        
        data.images.forEach((src, index) => {
            let blurClass = '';
            let lockOverlay = '';
            if (index === 2) {
                blurClass = 'blurred-content';
                lockOverlay = `
                    <div class="lock-overlay" onclick="buyVip()">
                        <div class="lock-icon">üîí</div>
                        <div class="lock-text">–°–∫—Ä—ã—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç</div>
                        <button class="lock-btn">–û—Ç–∫—Ä—ã—Ç—å –≤ VIP</button>
                    </div>
                `;
            }
            slidesHtml += `
                <div class="slider-slide">
                    <img src="${src}" class="${blurClass}">
                    ${lockOverlay}
                </div>
            `;
        });
        sliderCont.innerHTML = slidesHtml;
        sliderDots.innerHTML = data.images.map((_, i) => `<div class="dot ${i===0?'active':''}"></div>`).join('');
        
        document.getElementById('d-name').innerText = data.name;
        document.getElementById('d-age').innerText = getAgeString(data.age);
        document.getElementById('d-height').innerText = `${data.height} —Å–º`;
        
        const priceCont = document.getElementById('d-price-container');
        if (data.discountPrice) {
            priceCont.innerHTML = `<div class="old-price">${data.price}</div><div class="new-price">${data.discountPrice}</div>`;
        } else {
            priceCont.innerHTML = `<div class="new-price" style="color:var(--accent)">${data.price}</div>`;
        }
        
        document.getElementById('d-desc').innerText = data.desc;
        renderReviews();
        
        const btnBook = document.getElementById('btn-book');
        const interceptContainer = document.getElementById('intercept-container');

        if (data.status === 'busy') {
            btnBook.innerText = `‚è≥ –ó–∞–Ω—è—Ç–∞ –¥–æ ${data.freeAt || '22:00'}`;
            btnBook.className = 'btn btn-secondary';
            btnBook.onclick = null;
            interceptContainer.style.display = 'block'; 
        } else {
           btnBook.innerText = 'üìÖ –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å (399‚ÇΩ)';
           btnBook.className = 'btn btn-primary';
           btnBook.onclick = bookCurrentModel; 
           interceptContainer.style.display = 'none'; 
        }

        document.getElementById('filters-wrapper').style.display = 'none';
        document.querySelector('.brand-header').style.display = 'none';
        document.getElementById('catalog-screen').classList.remove('active');
        
        // requestAnimationFrame –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
        requestAnimationFrame(() => {
            document.getElementById('detail-screen').classList.add('active');
            window.scrollTo(0,0);
        });
        if(tg.BackButton) tg.BackButton.show();
    }

    function closeDetail() {
        document.getElementById('detail-screen').classList.remove('active');
        document.getElementById('catalog-screen').classList.add('active');
        document.getElementById('filters-wrapper').style.display = 'block';
        document.querySelector('.brand-header').style.display = 'block';
        if(tg.BackButton) tg.BackButton.hide();
        currentModelId = null;
    }
    
    if(tg.BackButton) tg.BackButton.onClick(closeDetail);

    function getAgeString(age) {
        let txt;
        let count = age % 100;
        if (count >= 5 && count <= 20) txt = '–ª–µ—Ç';
        else {
            count = age % 10;
            if (count == 1) txt = '–≥–æ–¥';
            else if (count >= 2 && count <= 4) txt = '–≥–æ–¥–∞';
            else txt = '–ª–µ—Ç';
        }
        return `${age} ${txt}`;
    }

    function updateDots() {
        const container = document.getElementById('slider-container');
        const index = Math.round(container.scrollLeft / container.offsetWidth);
        const dots = document.querySelectorAll('.dot');
        dots.forEach((dot, i) => {
            if (i === index) dot.classList.add('active');
            else dot.classList.remove('active');
        });
    }

    // --- –ü–û–ö–£–ü–ö–ò –ò –î–ï–ô–°–¢–í–ò–Ø ---

    function buyVip() {
        haptic('medium');
        document.getElementById('vip-window').classList.add('active');
    }

    function closeVip() {
        document.getElementById('vip-window').classList.remove('active');
    }

    function processVipPayment() {
        haptic('heavy');
        const check = document.getElementById('anon-check-vip');
        const isAnon = check ? check.checked : false;
        tg.sendData(isAnon ? `BUY_VIP_ANON` : `BUY_VIP`);
    }

    function fakeMessageAlert() {
        haptic('warning');
        if(!currentModelId) return;
        const data = modelsData[currentModelId];
        tg.showPopup({
            title: `–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç ${data.name}`,
            message: `–£ –≤–∞—Å 1 –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ. –û–ø–ª–∞—Ç–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É —á–∞—Ç—É, —á—Ç–æ–±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å.`,
            buttons: [
                {type: 'default', text: '–û–ø–ª–∞—Ç–∏—Ç—å 199‚ÇΩ', id: 'pay_msg'},
                {type: 'cancel'}
            ]
        }, function(btnId) {
            if (btnId === 'pay_msg') buyPriorityMsg();
        });
    }

    function showVerification() {
        haptic('success');
        tg.showPopup({
            title: '–õ–∏—á–Ω–æ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞',
            message: '–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–∞ 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏. –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–µ–π ZATMENIE Club.',
            buttons: [{type: 'ok'}]
        });
    }

    function trySwitchMode(e) {
        e.preventDefault(); 
        haptic('warning');
        tg.showPopup({
            title: '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω',
            message: '–†–µ–∂–∏–º 18+ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —á–ª–µ–Ω–æ–≤ VIP –∫–ª—É–±–∞. –ñ–µ–ª–∞–µ—Ç–µ –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø?',
            buttons: [
                {type: 'default', text: '–ö—É–ø–∏—Ç—å VIP', id: 'buy_vip'},
                {type: 'cancel'}
            ]
        }, function(btnId) {
            if (btnId === 'buy_vip') buyVip();
        });
        return false;
    }

    function sendGift(type, price) {
        if(!currentModelId) return;
        haptic('medium');
        tg.sendData(`BUY_GIFT_${type.toUpperCase()}_${currentModelId}`);
    }

    function buyPriorityMsg() {
        if(!currentModelId) return;
        haptic('heavy');
        tg.sendData(`BUY_PRIORITY_${currentModelId}`);
    }

    function interceptBooking() {
        if(!currentModelId) return;
        haptic('error');
        tg.sendData(`BUY_INTERCEPT_${currentModelId}`);
    }

    function bookCurrentModel() {
       if(!currentModelId) return;
       haptic('heavy');
       tg.sendData(`BUY_BOOKING_${currentModelId}`);
    }

    function buyPhotoPack() {
        if(!currentModelId) return;
        haptic('heavy');
        const check = document.getElementById('anon-check-pack');
        const isAnon = check ? check.checked : false;
        tg.sendData(isAnon ? `BUY_PACK_${currentModelId}_ANON` : `BUY_PACK_${currentModelId}`);
    }

    // –ó–∞–ø—É—Å–∫
    preloadImages();
    renderCatalog();

</script>
</body>
</html>
